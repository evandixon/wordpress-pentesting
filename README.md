# WordPress Pentesting

Time spent: 4 hours spent in total

## Pentesting Report

1. Unauthenticated Stored Cross-Site Scripting (XSS)
  - Summary: MySQL truncates content longer than about 64KB, resulting in a malformed HTML tag that allows the execution of JavaScript. [Source](https://klikki.fi/adv/wordpress2.html)
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.1
  - Steps to recreate: 
	- Customize the JS in the onmouseover event in vuln1.txt
	- Post the code located in [vuln1.txt](https://github.com/evandixon/wordpress-pentesting/blob/master/vuln1.txt) in the body of a comment
  - [Screenshot](https://github.com/evandixon/wordpress-pentesting/blob/master/vuln1.png)
2. Unauthenticated Genericons Cross-Site Scripting (XSS)
  - Summary: Sample file included in a default theme is vulnerable to query-string-based HTML and JS injection. [Source](https://wpvulndb.com/vulnerabilities/7979)
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.2
  - Steps to recreate: 
	- Append "/wp-content/themes/twentyfifteen/genericons/example.html#1<img/ src=1 onerror= alert(1)>" to the home URL of an affected WordPress installation.
  - Affected source code:
    - [Genericons' example.html](https://core.trac.wordpress.org/browser/tags/4.2/src/wp-content/themes/twentyfifteen/genericons/example.html?rev=32282#L309)
  - [Screenshot](https://github.com/evandixon/wordpress-pentesting/blob/master/vuln2.PNG)
3. XSS in Media Upload when file too large
  - Summary: Filename of a file that is too large is not properly escaped before being displayed. [Source](https://hackerone.com/reports/203515)
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.7.5
  - Steps to recreate: 
    - Go to /wp-admin/media-new.php
	- Attempt to upload the file contained within [vul3-Sample.zip](https://github.com/evandixon/wordpress-pentesting/blob/master/vuln3-Sample.zip). The zip file will not extract properly on Windows, so Linux is required to reproduce.
  - Affected source code:
    - [script-loader.php](https://core.trac.wordpress.org/browser/tags/4.2/src/wp-includes/script-loader.php?rev=32282#L248)
	- [handlers.js](https://core.trac.wordpress.org/browser/tags/4.2/src/wp-includes/js/plupload/handlers.js?rev=32282#L339)
  - [Screenshot](https://github.com/evandixon/wordpress-pentesting/blob/master/vuln3.PNG)
## Assets

* [vuln1.txt](https://github.com/evandixon/wordpress-pentesting/blob/master/vuln1.txt) - To be posted in a comment for use with Unauthenticated Stored Cross-Site Scripting (XSS).
* [vuln3-Sample.zip](https://github.com/evandixon/wordpress-pentesting/blob/master/vuln3-Sample.zip) - Sample large file for use with XSS in Media Upload when file too large.